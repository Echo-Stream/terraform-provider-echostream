fragment functionFields on Function {
    code
    description
    inUse
    name
    readme
    requirements
    system
}

fragment bitmapperFunctionFields on BitmapperFunction {
    argumentMessageType {
        name
    }
}

fragment processorFunctionFields on ProcessorFunction {
    argumentMessageType {
        name
    }
    returnMessageType {
        name
    }
}

mutation CreateApiAuthenticatorFunction(
    $code: String!,
    $description: String!,
    $name: String!,
    $tenant: String!,
    $readme: String,
    $requirements: [String!]
) {
    CreateApiAuthenticatorFunction(
        code: $code,
        description: $description,
        name: $name,
        tenant: $tenant,
        readme: $readme,
        requirements: $requirements
    ) {
        ...functionFields
    }
}

mutation CreateBitmapperFunction(
    $argumentMessageType: String!,
    $code: String!,
    $description: String!,
    $name: String!,
    $tenant: String!,
    $readme: String,
    $requirements: [String!]
) {
    CreateBitmapperFunction(
        argumentMessageType: $argumentMessageType,
        code: $code,
        description: $description,
        name: $name,
        tenant: $tenant,
        readme: $readme,
        requirements: $requirements
    ) {
        ...functionFields
        ...bitmapperFunctionFields
    }
}

mutation CreateProcessorFunction(
    $argumentMessageType: String!,
    $code: String!,
    $description: String!,
    $name: String!,
    $tenant: String!,
    $readme: String,
    $requirements: [String!],
    $returnMessageType: String
) {
    CreateProcessorFunction(
        argumentMessageType: $argumentMessageType,
        code: $code,
        description: $description,
        name: $name,
        tenant: $tenant,
        readme: $readme,
        requirements: $requirements
        returnMessageType: $returnMessageType
    ) {
        ...functionFields
        ...processorFunctionFields
    }
}

query DeleteFunction($name: String!, $tenant: String!) {
    GetFunction(name: $name, tenant: $tenant) {
        Delete
    }
}

query ReadFunction($name: String!, $tenant: String!) {
    GetFunction(name: $name, tenant: $tenant) {
        ...functionFields
        ... on BitmapperFunction {
            ...bitmapperFunctionFields
        }
        ... on ProcessorFunction {
            ...processorFunctionFields
        }
    }
}

query UpdateFunction(
    $name: String!,
    $tenant: String!,
    $code: String,
    $description: String,
    $readme: String,
    $requirements: [String!]
) {
    GetFunction(name: $name, tenant: $tenant) {
        ... on ApiAuthenticatorFunction {
            Update(
                code: $code,
                description: $description, 
                readme: $readme,
                requirements: $requirements
            ) {
                ...functionFields
            }
        }
        ... on BitmapperFunction {
            Update(
                code: $code,
                description: $description, 
                readme: $readme,
                requirements: $requirements
            ) {
                ...functionFields
                ...bitmapperFunctionFields
            }
        }        
        ... on ProcessorFunction {
            Update(
                code: $code,
                description: $description, 
                readme: $readme,
                requirements: $requirements
            ) {
                ...functionFields
                ...processorFunctionFields
            }
        }        
    }
}
